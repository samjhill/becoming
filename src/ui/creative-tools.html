<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creative Tools - Production Journal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            font-weight: 300;
        }

        .btn-back {
            display: inline-block;
            padding: 10px 20px;
            background: #6c757d;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .btn-back:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .tool-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }

        .tool-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        select, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .chord-progression {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #e9ecef;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .chord-progression h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .chords-display {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .chord {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: 600;
            text-align: center;
            min-width: 80px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
        }

        .progression-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid #667eea;
        }

        .progression-info h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .progression-info p {
            color: #666;
            line-height: 1.5;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .status-message {
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
            font-weight: 500;
            display: none;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            .form-row {
                flex-direction: column;
                gap: 15px;
            }
            .button-group {
                flex-direction: column;
            }
            .btn {
                width: 100%;
            }
            .chords-display {
                justify-content: center;
            }
            h1 {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            .chord {
                padding: 12px 15px;
                font-size: 1.1em;
                min-width: 70px;
            }
            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="http://localhost:8082/" class="btn-back">‚Üê Back to Home</a>
        
        <h1>üé® Creative Tools</h1>
        <p style="text-align: center; color: #666; margin-bottom: 30px;">
            Break through creative blocks with these production tools
        </p>

        <div class="tool-section">
            <div class="tool-title">
                üéµ Chord Progression Generator
            </div>
            <p style="color: #666; margin-bottom: 20px;">
                Stuck on a chord progression? Let's generate some inspiration based on your key and mode!
            </p>

            <div class="form-row">
                <div class="form-group">
                    <label for="key">Key:</label>
                    <select id="key">
                        <option value="C">C</option>
                        <option value="C#">C#</option>
                        <option value="D">D</option>
                        <option value="D#">D#</option>
                        <option value="E">E</option>
                        <option value="F">F</option>
                        <option value="F#">F#</option>
                        <option value="G">G</option>
                        <option value="G#">G#</option>
                        <option value="A">A</option>
                        <option value="A#">A#</option>
                        <option value="B">B</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="mode">Mode:</label>
                    <select id="mode">
                        <option value="major">Major</option>
                        <option value="minor">Minor</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="progressionType">Progression Type:</label>
                    <select id="progressionType">
                        <option value="classic">Classic</option>
                        <option value="jazz">Jazz</option>
                        <option value="pop">Pop</option>
                        <option value="blues">Blues</option>
                        <option value="emotional">Emotional</option>
                        <option value="uplifting">Uplifting</option>
                        <option value="mysterious">Mysterious</option>
                        <option value="romantic">Romantic</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="chordCount">Number of Chords:</label>
                    <select id="chordCount">
                        <option value="4">4 Chords</option>
                        <option value="6">6 Chords</option>
                        <option value="8">8 Chords</option>
                    </select>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="generateProgression()">üéµ Generate Progression</button>
                <button class="btn btn-secondary" onclick="randomizeKey()">üé≤ Random Key</button>
            </div>

            <div id="progressionResult"></div>
        </div>

        <div id="statusMessage" class="status-message"></div>
    </div>

    <script>
        // Chord progression database - Music theory compliant
        const chordProgressions = {
            major: {
                classic: [
                    [1, 5, 6, 4], // I-V-vi-IV (authentic cadence with deceptive resolution)
                    [1, 6, 4, 5], // I-vi-IV-V (plagal motion with authentic cadence)
                    [1, 4, 5, 1], // I-IV-V-I (perfect authentic cadence)
                    [6, 4, 1, 5], // vi-IV-I-V (deceptive to authentic)
                    [1, 3, 6, 4], // I-iii-vi-IV (circle of fifths motion)
                    [2, 5, 1, 6], // ii-V-I-vi (jazz turnaround)
                ],
                jazz: [
                    [1, 6, 2, 5], // I-vi-ii-V (classic jazz progression)
                    [1, 3, 6, 2, 5, 1], // I-iii-vi-ii-V-I (extended circle of fifths)
                    [2, 5, 1, 6], // ii-V-I-vi (jazz turnaround)
                    [1, 6, 2, 5], // I-vi-ii-V (repeated for variation)
                    [6, 2, 5, 1], // vi-ii-V-I (minor ii-V-I)
                    [3, 6, 2, 5], // iii-vi-ii-V (minor key progression)
                ],
                pop: [
                    [1, 5, 6, 4], // I-V-vi-IV (most popular progression)
                    [6, 1, 4, 5], // vi-I-IV-V (relative minor start)
                    [4, 5, 1, 6], // IV-V-I-vi (plagal to deceptive)
                    [1, 6, 3, 4], // I-vi-iii-IV (smooth voice leading)
                    [2, 4, 1, 5], // ii-IV-I-V (pre-dominant to dominant)
                    [6, 4, 1, 5], // vi-IV-I-V (deceptive to authentic)
                ],
                blues: [
                    [1, 1, 4, 1, 5, 4, 1, 5], // I-I-IV-I-V-IV-I-V (8-bar blues)
                    [1, 4, 1, 1, 4, 4, 1, 5, 4, 1, 5, 5], // 12-bar blues
                    [1, 1, 1, 1, 4, 4, 1, 1, 5, 4, 1, 5], // 12-bar variation
                    [1, 4, 1, 1, 4, 4, 1, 1, 5, 5, 1, 1], // 12-bar with extended V
                ],
                emotional: [
                    [6, 4, 1, 5], // vi-IV-I-V (relative minor to major)
                    [1, 6, 3, 4], // I-vi-iii-IV (smooth descending motion)
                    [6, 2, 4, 5], // vi-ii-IV-V (minor ii-V-I setup)
                    [6, 4, 2, 5], // vi-IV-ii-V (pre-dominant chain)
                    [1, 6, 4, 5], // I-vi-IV-V (classic emotional)
                    [6, 3, 4, 1], // vi-iii-IV-I (minor to major resolution)
                ],
                uplifting: [
                    [1, 4, 5, 1], // I-IV-V-I (perfect authentic cadence)
                    [1, 5, 6, 4], // I-V-vi-IV (bright major progression)
                    [4, 1, 5, 6], // IV-I-V-vi (plagal to deceptive)
                    [1, 3, 4, 5], // I-iii-IV-V (ascending motion)
                    [5, 1, 4, 1], // V-I-IV-I (authentic cadence with plagal)
                    [1, 4, 6, 5], // I-IV-vi-V (major to relative minor)
                ],
                mysterious: [
                    [6, 3, 4, 1], // vi-iii-IV-I (minor to major with tension)
                    [2, 6, 4, 5], // ii-vi-IV-V (pre-dominant chain)
                    [6, 4, 2, 5], // vi-IV-ii-V (minor key progression)
                    [3, 6, 2, 5], // iii-vi-ii-V (minor circle of fifths)
                    [6, 2, 3, 6], // vi-ii-iii-vi (minor key oscillation)
                    [2, 3, 6, 4], // ii-iii-vi-IV (chromatic motion)
                ],
                romantic: [
                    [1, 6, 4, 5], // I-vi-IV-V (classic romantic)
                    [6, 4, 1, 5], // vi-IV-I-V (relative minor start)
                    [4, 6, 1, 5], // IV-vi-I-V (plagal motion)
                    [1, 3, 6, 4], // I-iii-vi-IV (smooth voice leading)
                    [6, 1, 4, 5], // vi-I-IV-V (minor to major)
                    [4, 1, 6, 5], // IV-I-vi-V (plagal to deceptive)
                ]
            },
            minor: {
                classic: [
                    [6, 4, 1, 5], // vi-IV-I-V (relative minor to major)
                    [1, 5, 6, 4], // i-v-vi-IV (minor authentic cadence with deceptive resolution)
                    [1, 4, 5, 1], // i-iv-v-i (minor perfect authentic cadence)
                    [6, 2, 5, 1], // vi-ii-V-i (minor ii-V-I)
                    [1, 6, 4, 5], // i-vi-iv-v (minor plagal motion)
                    [6, 4, 2, 5], // vi-iv-ii-V (minor pre-dominant chain)
                ],
                jazz: [
                    [1, 6, 2, 5], // i-vi-ii-V (minor jazz progression)
                    [2, 5, 1, 6], // ii-V-i-vi (minor ii-V-I to relative major)
                    [1, 3, 6, 2, 5, 1], // i-iii-vi-ii-V-i (extended minor circle of fifths)
                    [6, 2, 5, 1], // vi-ii-V-i (minor ii-V-I)
                    [1, 6, 2, 5], // i-vi-ii-V (classic minor jazz)
                    [3, 6, 2, 5], // iii-vi-ii-V (minor key progression)
                ],
                pop: [
                    [6, 4, 1, 5], // vi-IV-i-V (relative minor start)
                    [1, 5, 6, 4], // i-v-vi-IV (minor authentic with deceptive resolution)
                    [4, 5, 1, 6], // IV-v-i-vi (minor plagal to deceptive)
                    [1, 6, 3, 4], // i-vi-iii-IV (minor smooth voice leading)
                    [2, 4, 1, 5], // ii-iv-i-v (minor pre-dominant to dominant)
                    [6, 4, 1, 5], // vi-iv-i-v (minor deceptive to authentic)
                ],
                blues: [
                    [1, 1, 4, 1, 5, 4, 1, 5], // i-i-iv-i-v-iv-i-v (minor 8-bar blues)
                    [1, 4, 1, 1, 4, 4, 1, 5, 4, 1, 5, 5], // minor 12-bar blues
                    [1, 1, 1, 1, 4, 4, 1, 1, 5, 4, 1, 5], // minor 12-bar variation
                    [1, 4, 1, 1, 4, 4, 1, 1, 5, 5, 1, 1], // minor 12-bar with extended V
                ],
                emotional: [
                    [1, 6, 4, 5], // i-vi-iv-v (minor emotional progression)
                    [6, 4, 1, 5], // vi-iv-i-v (relative minor to major)
                    [1, 4, 6, 5], // i-iv-vi-v (minor plagal motion)
                    [6, 2, 4, 5], // vi-ii-iv-v (minor pre-dominant chain)
                    [1, 6, 3, 4], // i-vi-iii-IV (minor smooth descending motion)
                    [6, 3, 4, 1], // vi-iii-IV-i (minor to major resolution)
                ],
                uplifting: [
                    [1, 4, 5, 1], // i-iv-v-i (minor perfect authentic cadence)
                    [4, 1, 5, 6], // IV-i-v-vi (minor plagal to deceptive)
                    [1, 5, 6, 4], // i-v-vi-IV (minor authentic with deceptive resolution)
                    [1, 3, 4, 5], // i-iii-iv-v (minor ascending motion)
                    [5, 1, 4, 1], // v-i-iv-i (minor authentic with plagal)
                    [1, 4, 6, 5], // i-iv-vi-v (minor to relative major)
                ],
                mysterious: [
                    [1, 6, 4, 2], // i-vi-iv-ii (minor mysterious progression)
                    [6, 4, 1, 5], // vi-iv-i-v (minor deceptive to authentic)
                    [2, 6, 4, 5], // ii-vi-iv-v (minor pre-dominant chain)
                    [3, 6, 2, 5], // iii-vi-ii-v (minor circle of fifths)
                    [6, 2, 3, 6], // vi-ii-iii-vi (minor key oscillation)
                    [2, 3, 6, 4], // ii-iii-vi-IV (minor chromatic motion)
                ],
                romantic: [
                    [1, 6, 4, 5], // i-vi-iv-v (minor romantic progression)
                    [6, 4, 1, 5], // vi-iv-i-v (relative minor start)
                    [4, 6, 1, 5], // IV-vi-i-v (minor plagal motion)
                    [1, 3, 6, 4], // i-iii-vi-IV (minor smooth voice leading)
                    [6, 1, 4, 5], // vi-i-iv-v (relative minor to major)
                    [4, 1, 6, 5], // IV-i-vi-v (minor plagal to deceptive)
                ]
            }
        };

        const chordNames = {
            major: ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'],
            minor: ['Am', 'A#m', 'Bm', 'Cm', 'C#m', 'Dm', 'D#m', 'Em', 'Fm', 'F#m', 'Gm', 'G#m']
        };

        let lastProgression = null;

        function generateProgression() {
            const key = document.getElementById('key').value;
            const mode = document.getElementById('mode').value;
            const progressionType = document.getElementById('progressionType').value;
            const chordCount = parseInt(document.getElementById('chordCount').value);
            
            console.log('Generating progression:', { key, mode, progressionType, chordCount });

            // Get available progressions for this type
            const availableProgressions = chordProgressions[mode][progressionType];
            if (!availableProgressions) {
                showStatus('No progression available for this type', 'error');
                return;
            }

            // Filter progressions by chord count
            let matchingProgressions = availableProgressions.filter(prog => prog.length === chordCount);
            
            if (matchingProgressions.length === 0) {
                // Use all available progressions and extend/reduce as needed
                const adaptedProgressions = availableProgressions.map(baseProgression => {
                    let selectedProgression = [...baseProgression];
                    
                    if (chordCount > baseProgression.length) {
                        // Extend by repeating pattern
                        while (selectedProgression.length < chordCount) {
                            selectedProgression = [...selectedProgression, ...baseProgression];
                        }
                        selectedProgression = selectedProgression.slice(0, chordCount);
                    } else if (chordCount < baseProgression.length) {
                        // Reduce by taking first N chords
                        selectedProgression = selectedProgression.slice(0, chordCount);
                    }
                    
                    return selectedProgression;
                });
                
                matchingProgressions = adaptedProgressions;
            }

            // Pick a random progression - simplified and more reliable
            let progression;
            let attempts = 0;
            
            do {
                const randomIndex = Math.floor(Math.random() * matchingProgressions.length);
                progression = matchingProgressions[randomIndex];
                attempts++;
            } while (JSON.stringify(progression) === JSON.stringify(lastProgression) && 
                     attempts < 10 && matchingProgressions.length > 1);
            
            lastProgression = progression;
            console.log('Selected progression:', progression, 'from', matchingProgressions.length, 'options');
            
            // Convert to actual chord names
            const keyIndex = chordNames.major.indexOf(key);
            const chords = progression.map(degree => {
                const chordIndex = (keyIndex + degree - 1) % 12;
                return mode === 'major' ? chordNames.major[chordIndex] : chordNames.minor[chordIndex];
            });

            // Display the result
            displayProgression(chords, key, mode, progressionType);
        }

        function displayProgression(chords, key, mode, type) {
            const resultDiv = document.getElementById('progressionResult');
            
            const chordElements = chords.map(chord => 
                `<div class="chord">${chord}</div>`
            ).join('');

            const progressionInfo = getProgressionInfo(type, mode);

            resultDiv.innerHTML = `
                <div class="chord-progression">
                    <h3>üéµ Your ${type.charAt(0).toUpperCase() + type.slice(1)} Progression in ${key} ${mode}</h3>
                    <div class="chords-display">
                        ${chordElements}
                    </div>
                    <div class="progression-info">
                        <h4>üí° About this progression:</h4>
                        <p>${progressionInfo}</p>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="copyToClipboard('${chords.join(' - ')}')">üìã Copy Progression</button>
                        <button class="btn btn-primary" onclick="generateProgression()">üé≤ Generate Another</button>
                    </div>
                </div>
            `;
        }

        function getProgressionInfo(type, mode) {
            const info = {
                classic: `Timeless progressions following traditional harmony principles. Features authentic cadences, circle of fifths motion, and smooth voice leading. Perfect for any genre.`,
                jazz: `Sophisticated progressions with ii-V-I relationships, extended circle of fifths motion, and jazz harmony principles. Rich with substitutions and advanced chord movement.`,
                pop: `Catchy progressions that balance familiarity with musical interest. Uses authentic and deceptive cadences effectively. Radio-friendly and memorable.`,
                blues: `Authentic blues progressions with traditional 8-bar and 12-bar forms. Strong emphasis on I, IV, and V chords with characteristic blues harmony.`,
                emotional: `Progressions designed for emotional impact using relative minor relationships, smooth voice leading, and expressive chord movement. Perfect for ballads.`,
                uplifting: `Bright, positive progressions featuring major key harmony, authentic cadences, and ascending motion. Great for anthems and uplifting songs.`,
                mysterious: `Intriguing progressions using minor key harmony, chromatic motion, and tension-building techniques. Creates suspense and darker moods.`,
                romantic: `Sweet, tender progressions using smooth voice leading, plagal motion, and relative minor relationships. Perfect for love songs and intimate moments.`
            };
            return info[type] || 'A musically sound progression to inspire your creativity!';
        }

        function randomizeKey() {
            const keys = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
            const randomKey = keys[Math.floor(Math.random() * keys.length)];
            document.getElementById('key').value = randomKey;
            
            // Also randomize mode occasionally
            if (Math.random() < 0.3) {
                document.getElementById('mode').value = Math.random() < 0.5 ? 'major' : 'minor';
            }
            
            showStatus(`üé≤ Randomized to ${randomKey}`, 'success');
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showStatus('üìã Progression copied to clipboard!', 'success');
            }).catch(() => {
                showStatus('‚ùå Could not copy to clipboard', 'error');
            });
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = `status-message status-${type}`;
            statusDiv.style.display = 'block';
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }

        // Auto-generate a progression on page load
        window.onload = function() {
            generateProgression();
        };
    </script>
</body>
</html>
